import "pe"
rule CVE_20200601_87172_8 : CVE DETECTION RULE {
meta:
	  description = "Detects executables with self-defined elliptic curve cryptography parameters potentially exploiting CVE-2020-0601"
      author = "Emanuele De Lucia"
	  tlp = "white"
	  reference = "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0601"
   strings:
	  $hex = { 06 07 2a 86 48 ce 3d (01|02) 01 (02|30)  }  						 
   condition: 
	  (uint16 ( 0 ) == 0x5a4d and pe.number_of_signatures > 0 and $hex)
} 
